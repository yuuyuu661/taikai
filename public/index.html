<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>大会当日サイト（総当たり・2試合/ラウンド）</title>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <style>
    :root { color-scheme: light dark; }
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, 'Noto Sans JP', 'Yu Gothic', sans-serif; margin: 16px; }
    h1 { font-size: 1.4rem; margin: 0 0 8px; }
    .panel { border: 1px solid #ccc; border-radius: 12px; padding: 12px; margin-bottom: 12px; }
    .row { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 8px; align-items: start; }
    label { font-weight: 600; font-size: .92rem; }
    input[type=text], input[type=url], input[type=password], select { width: 100%; padding: 8px; border: 1px solid #bbb; border-radius: 8px; }
    input[type=file] { width: 100%; }
    button { padding: 8px 12px; border: 0; border-radius: 10px; background: #111; color: #fff; cursor: pointer; }
    button.secondary { background: #666; }
    .badge { display:inline-block; padding:2px 8px; border-radius:999px; background:#eee; font-size:.8rem; }
    .grid2 { display:grid; grid-template-columns: repeat(2, minmax(260px, 1fr)); gap: 8px; }
    .match { border: 1px solid #ddd; border-radius: 10px; padding: 8px; }
    .table { border-collapse: collapse; width: 100%; }
    .table th,.table td { border-bottom: 1px solid #ddd; padding: 6px 8px; text-align: left; }
    .sticky { position: sticky; top: 0; background: #fff; z-index: 1; padding: 8px 0; border-bottom: 1px solid #eee; }
    small { color: #666; }
    .tabs { display:flex; gap:8px; margin-bottom:12px; flex-wrap:wrap; }
    .tabs button { background:#eee; color:#111; }
    .tabs button.active { background:#111; color:#fff; }
    .tab { display:none; }
    .tab.active { display:block; }
    .only-admin { display:none; }
    .only-admin.show { display:block; }
    .teams-grid { display:grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }
    .team-card { border: 1px solid #ddd; border-radius: 12px; padding: 10px; display: grid; gap: 8px; }
    .team-card .header { text-align: center; font-weight: 800; font-size: 1.05rem; padding-bottom: 6px; border-bottom: 1px solid #eee; }
    .team-card .rowline { display: grid; grid-template-columns: 1fr 120px; align-items: center; gap: 10px; }
    .team-card .who { display:flex; align-items:center; gap:8px; min-height:32px; }
    .team-card .who .tag { font-weight:700; font-size:.85rem; background:#eef; color:#335; border-radius:6px; padding:2px 6px; }
    .team-card img.icon { height:28px; width:28px; border-radius:6px; border:1px solid #ddd; object-fit:cover; }
    .team-card .poke { display:flex; gap:6px; justify-content:flex-end; }
    .team-card .slot { width:28px; height:28px; border:1px solid #ddd; border-radius:6px; display:inline-block; overflow:hidden; }
    .team-card .slot img { width:100%; height:100%; object-fit:cover; display:block; }
    .team-card .slot.empty { background: repeating-linear-gradient(45deg, #f0f0f0, #f0f0f0 4px, #fafafa 4px, #fafafa 8px); opacity:.7; }
    @media (max-width: 980px) { .teams-grid { grid-template-columns: repeat(2, 1fr); } }
    @media (max-width: 640px) { .teams-grid { grid-template-columns: 1fr; } }
  </style>
</head>
<body>
  <h1>大会当日サイト（総当たり・2試合/ラウンド）</h1>

  <div class="panel">
    <div class="row">
      <div>
        <label>運営パスワード</label>
        <input type="password" id="adminKey" placeholder="ADMIN_PASSWORD" />
      </div>
      <div style="display:flex; gap:8px; align-items:end;">
        <button id="btnGen" class="only-admin">スケジュール生成（全消去→再生成）</button>
        <button id="btnReload" class="secondary">再読込</button>
      </div>
    </div>
    <small>※運営パス入力で「チーム登録」「編集」「結果確定」が可能になります。観戦者は対戦表・順位表・登録チームの閲覧のみ。</small>
  </div>

  <div class="tabs">
    <button data-tab="t1" class="active">1. 対戦表</button>
    <button data-tab="t2">2. 順位表</button>
    <button data-tab="t3">3. 登録済みチーム</button>
    <button data-tab="t4">4. チーム登録（運営）</button>
  </div>

  <div id="t1" class="tab active">
    <div class="panel">
      <div class="sticky"><h2>対戦表（2試合/ラウンド）</h2></div>
      <div id="schedule" class="grid2"></div>
    </div>
  </div>

  <div id="t2" class="tab">
    <div class="panel">
      <div class="sticky"><h2>順位表</h2></div>
      <table class="table" id="standings"></table>
    </div>
  </div>

  <div id="t3" class="tab">
    <div class="panel">
      <div class="sticky"><h2>登録済みチーム</h2></div>
      <div id="teamList" class="teams-grid"></div>
    </div>
  </div>

  <div id="t4" class="tab">
    <div class="panel">
      <h2>チーム登録（運営専用）</h2>
      <form id="teamForm" class="only-admin">
        <div class="row">
          <div><label>チーム名</label><input type="text" name="team_name" required></div>
          <div><label>リーダー名</label><input type="text" name="leader_name" required></div>
          <div><label>リーダーアイコン（アップ可）</label><input type="file" name="leader_icon" accept="image/*"></div>
          <div><label>リーダー使用ポケモン</label><select name="leader_poke1_url" id="leader_p1"></select></div>
          <div><label>　</label><select name="leader_poke2_url" id="leader_p2"></select></div>
          <div><label>　</label><select name="leader_poke3_url" id="leader_p3"></select></div>
        </div>
        <hr>
        <div class="row" id="members"></div>
        <div style="margin-top:8px;"><button>登録する</button></div>
      </form>
      <div class="only-admin"><small>※ 画像は <code>/public/images</code> に置くと選べます。</small></div>
    </div>
  </div>

  <script src="/app.js"></script>
</body>
</html>
